%%{init: {"securityLevel": "loose", "flowchart": {"htmlLabels": true}}}%%
flowchart TB
    %% 用户界面层
    subgraph UIGroup["用户界面层"]
        UI[桌面应用窗口<br/>1400x900]

        Editor[代码编辑器<br/>Monaco Editor]
        Chat[AI聊天助手<br/>多模型支持]
        Terminal[终端面板<br/>xterm.js]
        Output[CLI输出面板<br/>实时日志]
        Explorer[文件浏览器<br/>树形导航]
        Settings[设置面板<br/>配置管理]
    end

    %% 前端应用层
    subgraph Frontend["前端应用层 (Vue 3 + TypeScript)"]
        FE[Vue 3 前端应用]

        Pinia[Pinia状态管理<br/>app.ts, themeStore.ts]
        Router[Vue Router<br/>页面路由]
        Element[Element Plus UI<br/>组件库]
        Tailwind[Tailwind CSS<br/>样式框架]
        Monaco[Monaco Editor<br/>代码编辑]
        Xterm[xterm.js<br/>终端模拟]
    end

    %% Tauri通信层
    subgraph TauriComm["Tauri通信层"]
        IPC[Tauri IPC通信<br/>异步消息传递]

        Commands[Tauri命令<br/>commands.rs]
        Events[Tauri事件<br/>events.rs]
        FrontendAPI["@tauri-apps/api"]
    end

    %% 后端服务层
    subgraph Backend["后端服务层 (Rust + Tauri)"]
        BE[Rust 后端服务<br/>Tauri 2.0]

        Config[配置管理<br/>config/]
        DB[数据库服务<br/>SQLite + SeaORM]
        AI[AI服务集成<br/>reqwest]
        FS[文件系统服务<br/>tauri-plugin-fs]
        Process[进程管理服务<br/>tauri-plugin-process]
        TerminalService[终端服务<br/>tokio::process]
        Network[网络服务<br/>reqwest]
        System[系统工具<br/>sysinfo]
    end

    %% 系统资源层
    subgraph SysRes["系统资源层"]
        OS[操作系统<br/>Windows/macOS/Linux]
        Filesystem[本地文件系统<br/>读写权限]
        NetworkResources[网络资源<br/>HTTP/WebSocket]
        Processes[系统进程<br/>执行管理]
        SQLiteDB[(SQLite数据库<br/>data.db)]
    end

    %% 数据流和依赖关系
    UI --> FE

    FE --> Editor
    FE --> Chat
    FE --> Terminal
    FE --> Output
    FE --> Explorer
    FE --> Settings

    FE --> Pinia
    FE --> Router
    FE --> Element
    FE --> Tailwind
    FE --> Monaco
    FE --> Xterm

    FE --> FrontendAPI
    FrontendAPI --> IPC
    IPC --> Commands
    IPC --> Events

    Commands --> BE
    Events --> BE

    BE --> Config
    BE --> DB
    BE --> AI
    BE --> FS
    BE --> Process
    BE --> TerminalService
    BE --> Network
    BE --> System

    Config --> OS
    DB --> SQLiteDB
    FS --> Filesystem
    Process --> Processes
    TerminalService --> Processes
    AI --> NetworkResources
    Network --> NetworkResources
    System --> OS

    %% 样式定义
    classDef ui fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef frontend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef tauri fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef backend fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef system fill:#fce4ec,stroke:#880e4f,stroke-width:2px

    class UI,Editor,Chat,Terminal,Output,Explorer,Settings ui
    class FE,Pinia,Router,Element,Tailwind,Monaco,Xterm frontend
    class IPC,Commands,Events,FrontendAPI tauri
    class BE,Config,DB,AI,FS,Process,TerminalService,Network,System backend
    class OS,Filesystem,NetworkResources,Processes,SQLiteDB system

    %% 注释
    note1[架构特点：<br/>• 前后端分离<br/>• 类型安全通信<br/>• 异步处理<br/>• 模块化设计]
    note1 -.- BE